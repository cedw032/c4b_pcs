{"version":3,"sources":["hooks/useSocket.js","hooks/useMessenger.js","components/ChatBox.js","components/Button.js","components/LoginBox.js","App.js","index.js"],"names":["socket","io","connect","useSocket","listeners","useEffect","Object","entries","forEach","_ref","_ref2","slicedToArray","name","listener","on","_ref3","_ref4","removeEventListener","useMessenger","username","peer","_useState","useState","_useState2","log","setLog","addToLog","message","concat","toConsumableArray","objectSpread","at","moment","console","from","content","toISOString","emit","to","ChatBox","endClient","_useMessenger","_useMessenger2","sendMessage","input","setInput","getMessageClassname","cx","react_default","a","createElement","className","map","i","key","format","value","onChange","e","target","onKeyDown","Button","props","clicked","setClicked","clearTimeout","assign","onClick","setTimeout","LoginBox","onLogin","error","setError","_useState3","password","_useState4","credentials","setCredentials","credentialsRef","useRef","current","login","components_Button","children","App","setUsername","endClients","setEndClients","components_ChatBox","components_LoginBox","ReactDOM","render","src_App","document","getElementById"],"mappings":"6PAIMA,SAASC,EAAGC,UAmBHC,EAjBG,SAAAC,GAcjB,OAbAC,oBAAU,WAKT,OAJAC,OAAOC,QAAQH,GAAWI,QAAQ,SAAAC,GAAsB,IAAAC,EAAAJ,OAAAK,EAAA,EAAAL,CAAAG,EAAA,GAApBG,EAAoBF,EAAA,GAAdG,EAAcH,EAAA,GACvDV,EAAOc,GAAGF,EAAMC,KAGV,WACNP,OAAOC,QAAQH,GAAWI,QAAQ,SAAAO,GAAsB,IAAAC,EAAAV,OAAAK,EAAA,EAAAL,CAAAS,EAAA,GAApBH,EAAoBI,EAAA,GAAdH,EAAcG,EAAA,GACvDhB,EAAOiB,oBAAoBL,EAAMC,OAIjC,IAEIb,oDCoBOkB,EApCM,SAACC,EAAUC,GAAS,IAAAC,EAElBC,mBAAS,IAFSC,EAAAjB,OAAAK,EAAA,EAAAL,CAAAe,EAAA,GAEjCG,EAFiCD,EAAA,GAE5BE,EAF4BF,EAAA,GAIlCG,EAAW,SAAAC,GAAO,OAAIF,EAAM,GAAAG,OAAAtB,OAAAuB,EAAA,EAAAvB,CAC9BkB,GAD8B,CAAAlB,OAAAwB,EAAA,EAAAxB,CAAA,GAG7BqB,EAH6B,CAIhCI,GAAIC,IAAOL,EAAQI,UAIrBE,QAAQT,IAAI,OAAQJ,GAEpB,IAAMpB,EAASG,EAAU,CACxBwB,QAAS,SAAAA,GAAO,OAAIM,QAAQT,IAAI,UAAWG,IAAYA,EAAQO,MAAQd,GAAQM,EAASC,MAkBzF,MAAO,CAACH,EAfY,SAAAW,GAEnBT,EAAS,CACRS,UACAJ,GAAIC,MAASI,cACbF,KAAMf,IAGPnB,EAAOqC,KAAK,UAAW,CACtBC,GAAIlB,EACJe,eCQYI,EApCC,SAAA9B,GAA2B,IAAzBU,EAAyBV,EAAzBU,SAAUqB,EAAe/B,EAAf+B,UAAeC,EAEfvB,EAAaC,EAAUqB,GAFRE,EAAApC,OAAAK,EAAA,EAAAL,CAAAmC,EAAA,GAEnCjB,EAFmCkB,EAAA,GAE9BC,EAF8BD,EAAA,GAAArB,EAIhBC,mBAAS,IAJOC,EAAAjB,OAAAK,EAAA,EAAAL,CAAAe,EAAA,GAInCuB,EAJmCrB,EAAA,GAI5BsB,EAJ4BtB,EAAA,GAMpCuB,EAAsB,SAACnB,GAAD,OAAaoB,IACxC,UACApB,EAAQO,OAASf,GAAY,OAC7BQ,EAAQO,OAASf,GAAY,SAG9B,OACC6B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,qBACb3B,EAAI4B,IAAI,SAACzB,EAAS0B,GAAV,OACRL,EAAAC,EAAAC,cAAA,OACCI,IAAKD,EACLF,UAAWL,EAAoBnB,IAC/BqB,EAAAC,EAAAC,cAAA,YAAOvB,EAAQI,GAAGwB,OAAO,SAAzB,OACAP,EAAAC,EAAAC,cAAA,YAAOvB,EAAQO,KAAf,MACAc,EAAAC,EAAAC,cAAA,YAAOvB,EAAQQ,YAGjBa,EAAAC,EAAAC,cAAA,SACCM,MAAOZ,EACPa,SAAU,SAAAC,GAAC,OAAIb,EAASa,EAAEC,OAAOH,QACjCI,UAAW,SAAAF,GACI,UAAVA,EAAEJ,MACLX,EAAYC,GACZC,EAAS,UCAAgB,EA9BA,SAACC,GAAU,IAAAzC,EACKC,oBAAS,GADdC,EAAAjB,OAAAK,EAAA,EAAAL,CAAAe,EAAA,GAClB0C,EADkBxC,EAAA,GACTyC,EADSzC,EAAA,GAWzB,OANAlB,oBAAU,WACT,OAAO,WACF0D,GAASE,aAAaF,KAEzB,CAACA,IAIHf,EAAAC,EAAAC,cAAA,SAAA5C,OAAA4D,OAAA,GAAYJ,EAAZ,CACCK,QAAS,SAACT,GACLI,EAAMK,SAASL,EAAMK,UAErBJ,GAASE,aAAaF,GAE1BC,EAAWI,WAAW,WACrBJ,GAAW,IAjBO,OAoBpBb,UAAWJ,IACVe,EAAMX,UACNY,GAAW,eCuCAM,EA/DE,SAAA5D,GAAe,IAAb6D,EAAa7D,EAAb6D,QAAajD,EAELC,qBAFKC,EAAAjB,OAAAK,EAAA,EAAAL,CAAAe,EAAA,GAExBkD,EAFwBhD,EAAA,GAEjBiD,EAFiBjD,EAAA,GAAAkD,EAGOnD,mBAAS,CAC9CH,SAAU,GACVuD,SAAU,KALoBC,EAAArE,OAAAK,EAAA,EAAAL,CAAAmE,EAAA,GAGxBG,EAHwBD,EAAA,GAGXE,EAHWF,EAAA,GAQzBG,EAAiBC,mBACvBD,EAAeE,QAAUJ,EAEzB,IAAM5E,EAASG,EAAU,CACxB8E,MAAO,SAACV,GACP,GAAKA,EAMLC,EAASD,OANT,CACC,IAAMK,EAAcE,EAAeE,QACnCV,EAAQM,EAAYzD,cAStBA,EAEGyD,EAFHzD,SACAuD,EACGE,EADHF,SAGD,OACC1B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACboB,GACAvB,EAAAC,EAAAC,cAAA,QAAMC,UAAU,SAASoB,GAE1BvB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACdH,EAAAC,EAAAC,cAAA,wBACAF,EAAAC,EAAAC,cAAA,SACCM,MAAOrC,EACPsC,SAAU,SAAAC,GAAC,OAAImB,EAAe,CAC7B1D,SAAUuC,EAAEC,OAAOH,MACnBkB,iBAGH1B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACdH,EAAAC,EAAAC,cAAA,wBACAF,EAAAC,EAAAC,cAAA,SACCM,MAAOkB,EACPjB,SAAU,SAAAC,GAAC,OAAImB,EAAe,CAC7B1D,WACAuD,SAAUhB,EAAEC,OAAOH,YAGtBR,EAAAC,EAAAC,cAACgC,EAAD,CACCC,SAAS,QACThB,QAAS,WACRnE,EAAOqC,KACN,QACA,CAAClB,WAAUuD,wBCvBFU,MA7Bf,WAAe,IAAA/D,EAEkBC,mBAAS,IAF3BC,EAAAjB,OAAAK,EAAA,EAAAL,CAAAe,EAAA,GAEPF,EAFOI,EAAA,GAEG8D,EAFH9D,EAAA,GAAAkD,EAIsBnD,mBAAS,IAJ/BqD,EAAArE,OAAAK,EAAA,EAAAL,CAAAmE,EAAA,GAIPa,EAJOX,EAAA,GAIKY,EAJLZ,EAAA,GASd,OAJAxE,EAAU,CACTmF,WAAYC,IAGRpE,EAOJ6B,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACdH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SACbmC,EAAWlC,IAAI,SAACZ,EAAWa,GAAZ,OACfL,EAAAC,EAAAC,cAACsC,EAAD,CACClC,IAAKD,EACLlC,SAAUA,EACVqB,UAAWA,QAXdQ,EAAAC,EAAAC,cAACuC,EAAD,CAAUnB,QAASe,KCdtBK,IAASC,OAAO3C,EAAAC,EAAAC,cAAC0C,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.0623caae.chunk.js","sourcesContent":["import {useEffect} from 'react';\nimport io from 'socket.io-client';\n\n//const socket = io.connect('http://localhost:5000');\nconst socket = io.connect();\n\nconst useSocket = listeners => {\n\tuseEffect(() => {\n\t\tObject.entries(listeners).forEach(([name, listener]) => {\n\t\t\tsocket.on(name, listener);\n\t\t});\t\n\n\t\treturn () => {\n\t\t\tObject.entries(listeners).forEach(([name, listener]) => {\n\t\t\t\tsocket.removeEventListener(name, listener);\n\t\t\t});\t\n\t\t};\n\n\t}, []);\n\n\treturn socket;\n};\n\nexport default useSocket;","import {useState} from 'react';\nimport moment from 'moment';\nimport useSocket from './useSocket';\n\nconst useMessenger = (username, peer) => {\n\n\tconst [log, setLog] = useState([]);\n\n\tconst addToLog = message => setLog([\n\t\t...log, \n\t\t{\n\t\t\t...message,\n\t\t\tat: moment(message.at)\n\t\t}\n\t]);\n\n\tconsole.log('peer', peer);\n\n\tconst socket = useSocket({\n\t\tmessage: message => console.log('MESSAGE', message) || message.from == peer && addToLog(message),\n\t});\n\n\tconst sendMessage = content => {\n\n\t\taddToLog({\n\t\t\tcontent,\n\t\t\tat: moment().toISOString(),\n\t\t\tfrom: username,\n\t\t});\n\n\t\tsocket.emit('message', {\n\t\t\tto: peer,\n\t\t\tcontent,\n\t\t});\n\n\t};\n\n\treturn [log, sendMessage]\n};\n\nexport default useMessenger;","import React, {useState} from 'react';\nimport cx from 'classnames';\nimport useMessenger from '../hooks/useMessenger';\n\nconst ChatBox = ({username, endClient}) => {\n\n\tconst [log, sendMessage] = useMessenger(username, endClient);\n\n\tconst [input, setInput] = useState('');\n\n\tconst getMessageClassname = (message) => cx(\n\t\t'message',\n\t\tmessage.from === username && 'self',\n\t\tmessage.from !== username && 'peer',\n\t);\n\n\treturn (\n\t\t<div className='panel message-box'>\n\t\t\t{log.map((message, i) => \n\t\t\t\t<div \n\t\t\t\t\tkey={i}\n\t\t\t\t\tclassName={getMessageClassname(message)}>\n\t\t\t\t\t<span>{message.at.format('h:mma')} - </span>\n\t\t\t\t\t<span>{message.from}: </span>\n\t\t\t\t\t<span>{message.content}</span>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<input \n\t\t\t\tvalue={input} \n\t\t\t\tonChange={e => setInput(e.target.value)}\n\t\t\t\tonKeyDown={e => {\n\t\t\t\t\tif (e.key === 'Enter') {\n\t\t\t\t\t\tsendMessage(input);\n\t\t\t\t\t\tsetInput('');\n\t\t\t\t\t}\n\t\t\t\t}}/>\n\t\t</div>\n\t);\n}\n\nexport default ChatBox;","import React, {useState, useEffect} from 'react';\nimport cx from 'classnames';\n\nconst Button = (props) => {\n\tconst [clicked, setClicked] = useState(false);\n\n\tconst clickDuration = 140;\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (clicked) clearTimeout(clicked);\t\t\n\t\t};\n\t}, [clicked]);\n\n\treturn (\n\n\t\t<button {...props}\n\t\t\tonClick={(e) => {\n\t\t\t\tif (props.onClick) props.onClick();\n\n\t\t\t\tif (clicked) clearTimeout(clicked);\n\n\t\t\t\tsetClicked(setTimeout(() => {\n\t\t\t\t\tsetClicked(false);\n\t\t\t\t}, clickDuration));\n\t\t\t}}\n\t\t\tclassName={cx(\n\t\t\t\tprops.className,\n\t\t\t\tclicked && 'clicked'\n\t\t\t)}/>\n\t);\n};\n\nexport default Button;\n\n","import React, {useState, useRef} from 'react';\nimport useSocket from '../hooks/useSocket';\nimport Button from './Button'\n\nconst LoginBox = ({onLogin}) => {\n\n\tconst [error, setError] = useState();\n\tconst [credentials, setCredentials] = useState({\n\t\tusername: '',\n\t\tpassword: '',\n\t});\n\n\tconst credentialsRef = useRef();\n\tcredentialsRef.current = credentials;\n\n\tconst socket = useSocket({\n\t\tlogin: (error) => {\n\t\t\tif (!error) { \n\t\t\t\tconst credentials = credentialsRef.current;\n\t\t\t\tonLogin(credentials.username);\t\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetError(error);\n\t\t}\n\t});\n\n\tconst {\n\t\tusername,\n\t\tpassword,\n\t} = credentials;\n\n\treturn (\n\t\t<div className='panel'>\n\t\t\t{error &&\n\t\t\t\t<span className='error'>{error}</span>\n\t\t\t}\n\t\t\t<div className='row'>\n\t\t\t\t<span>username</span>\n\t\t\t\t<input \n\t\t\t\t\tvalue={username} \n\t\t\t\t\tonChange={e => setCredentials({\n\t\t\t\t\t\tusername: e.target.value,\n\t\t\t\t\t\tpassword,\n\t\t\t\t\t})}/>\n\t\t\t</div>\n\t\t\t<div className='row'>\n\t\t\t\t<span>password</span>\n\t\t\t\t<input \n\t\t\t\t\tvalue={password} \n\t\t\t\t\tonChange={e => setCredentials({\n\t\t\t\t\t\tusername,\n\t\t\t\t\t\tpassword: e.target.value,\n\t\t\t\t\t})}/>\n\t\t\t</div>\n\t\t\t<Button \n\t\t\t\tchildren='Login'\n\t\t\t\tonClick={() => {\n\t\t\t\t\tsocket.emit(\n\t\t\t\t\t\t'login',\n\t\t\t\t\t\t{username, password}\n\t\t\t\t\t);\n\t\t\t\t}}/>\n\t\t</div>\n\t); \n}\n\nexport default LoginBox;","import React, {useState} from 'react';\n\nimport useSocket from './hooks/useSocket';\nimport ChatBox from './components/ChatBox'\nimport LoginBox from './components/LoginBox';\n\nimport './App.css';\n\nfunction App() {\n\n\tconst [username, setUsername] = useState('');\n\n\tconst [endClients, setEndClients] = useState([]);\n\tuseSocket({\n\t\tendClients: setEndClients,\n\t});\n\n\tif (!username) {\n\t\treturn (\n\t\t\t<LoginBox onLogin={setUsername}/>\n\t\t);\n\t} \n\n\treturn (\n\t\t<div className='app'>\n\t\t\t<div className='panel'>\n\t\t\t\t{endClients.map((endClient, i) => \n\t\t\t\t\t<ChatBox\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tusername={username}\n\t\t\t\t\t\tendClient={endClient}/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}